{
    "subset": "synthetic",
    "id": "481659f3ba97f6dd68c52a9a8a3d02186c707062a1814dc30da9c773f501550a",
    "train_samples": [
        {
            "inp": {
                "grid": [
                    [
                        3,
                        4,
                        1,
                        1,
                        1
                    ],
                    [
                        2,
                        5,
                        1,
                        1,
                        1
                    ],
                    [
                        1,
                        1,
                        1,
                        1,
                        1
                    ],
                    [
                        1,
                        1,
                        1,
                        1,
                        1
                    ],
                    [
                        1,
                        1,
                        1,
                        1,
                        1
                    ]
                ],
                "expr": [
                    "->",
                    [
                        "new-grid",
                        [
                            [
                                ".",
                                "jnp",
                                "array"
                            ],
                            [
                                5,
                                5
                            ]
                        ]
                    ],
                    [
                        "draw",
                        [
                            [
                                ".",
                                "jnp",
                                "array"
                            ],
                            [
                                0,
                                0
                            ]
                        ],
                        [
                            "apply-texture",
                            [
                                [
                                    ".",
                                    "jnp",
                                    "array"
                                ],
                                [
                                    [
                                        [
                                            ".",
                                            "Color",
                                            "RED"
                                        ],
                                        [
                                            ".",
                                            "Color",
                                            "GREEN"
                                        ]
                                    ],
                                    [
                                        [
                                            ".",
                                            "Color",
                                            "BLUE"
                                        ],
                                        [
                                            ".",
                                            "Color",
                                            "YELLOW"
                                        ]
                                    ]
                                ]
                            ],
                            [
                                "rect-mask",
                                [
                                    [
                                        ".",
                                        "jnp",
                                        "array"
                                    ],
                                    [
                                        2,
                                        2
                                    ]
                                ]
                            ]
                        ]
                    ],
                    [
                        "color-background",
                        [
                            ".",
                            "Color",
                            "BLACK"
                        ]
                    ]
                ],
                "code": "(-> (new-grid (jnp.array [5 5]))\n    (draw (jnp.array [0 0]) (apply-texture (jnp.array [[Color.RED Color.GREEN] [Color.BLUE Color.YELLOW]]) (rect-mask (jnp.array [2 2]))))\n    (color-background Color.BLACK))"
            },
            "out": {
                "grid": [
                    [
                        3,
                        4,
                        3,
                        4,
                        3,
                        3,
                        4,
                        3,
                        4,
                        3
                    ],
                    [
                        2,
                        5,
                        2,
                        5,
                        2,
                        2,
                        5,
                        2,
                        5,
                        2
                    ],
                    [
                        3,
                        4,
                        3,
                        4,
                        3,
                        3,
                        4,
                        3,
                        4,
                        3
                    ],
                    [
                        2,
                        5,
                        2,
                        5,
                        2,
                        2,
                        5,
                        2,
                        5,
                        2
                    ],
                    [
                        3,
                        4,
                        3,
                        4,
                        3,
                        3,
                        4,
                        3,
                        4,
                        3
                    ],
                    [
                        3,
                        4,
                        3,
                        4,
                        3,
                        3,
                        4,
                        3,
                        4,
                        3
                    ],
                    [
                        2,
                        5,
                        2,
                        5,
                        2,
                        2,
                        5,
                        2,
                        5,
                        2
                    ],
                    [
                        3,
                        4,
                        3,
                        4,
                        3,
                        3,
                        4,
                        3,
                        4,
                        3
                    ],
                    [
                        2,
                        5,
                        2,
                        5,
                        2,
                        2,
                        5,
                        2,
                        5,
                        2
                    ],
                    [
                        3,
                        4,
                        3,
                        4,
                        3,
                        3,
                        4,
                        3,
                        4,
                        3
                    ]
                ],
                "expr": [
                    "->",
                    [
                        "new-grid",
                        [
                            "*",
                            2,
                            [
                                [
                                    ".",
                                    "jnp",
                                    "array"
                                ],
                                [
                                    5,
                                    5
                                ]
                            ]
                        ]
                    ],
                    [
                        "draw",
                        [
                            [
                                ".",
                                "jnp",
                                "array"
                            ],
                            [
                                0,
                                0
                            ]
                        ],
                        [
                            "add-quad-mirror",
                            [
                                "apply-texture",
                                [
                                    [
                                        ".",
                                        "jnp",
                                        "array"
                                    ],
                                    [
                                        [
                                            [
                                                ".",
                                                "Color",
                                                "RED"
                                            ],
                                            [
                                                ".",
                                                "Color",
                                                "GREEN"
                                            ]
                                        ],
                                        [
                                            [
                                                ".",
                                                "Color",
                                                "BLUE"
                                            ],
                                            [
                                                ".",
                                                "Color",
                                                "YELLOW"
                                            ]
                                        ]
                                    ]
                                ],
                                [
                                    "rect-mask",
                                    [
                                        [
                                            ".",
                                            "jnp",
                                            "array"
                                        ],
                                        [
                                            5,
                                            5
                                        ]
                                    ]
                                ]
                            ]
                        ]
                    ],
                    [
                        "color-background",
                        [
                            ".",
                            "Color",
                            "BLACK"
                        ]
                    ]
                ],
                "code": "(-> (new-grid (* 2 ((. jnp array) [5 5]))) (draw ((. jnp array) [0 0]) (add-quad-mirror (apply-texture ((. jnp array) [[(. Color RED) (. Color GREEN)] [(. Color BLUE) (. Color YELLOW)]]) (rect-mask ((. jnp array) [5 5]))))) (color-background (. Color BLACK)))"
            }
        },
        {
            "inp": {
                "grid": [
                    [
                        2,
                        7,
                        1,
                        1
                    ],
                    [
                        7,
                        2,
                        1,
                        1
                    ],
                    [
                        1,
                        1,
                        1,
                        1
                    ],
                    [
                        1,
                        1,
                        1,
                        1
                    ]
                ],
                "expr": [
                    "->",
                    [
                        "new-grid",
                        [
                            [
                                ".",
                                "jnp",
                                "array"
                            ],
                            [
                                4,
                                4
                            ]
                        ]
                    ],
                    [
                        "draw",
                        [
                            [
                                ".",
                                "jnp",
                                "array"
                            ],
                            [
                                0,
                                0
                            ]
                        ],
                        [
                            "apply-texture",
                            [
                                [
                                    ".",
                                    "jnp",
                                    "array"
                                ],
                                [
                                    [
                                        [
                                            ".",
                                            "Color",
                                            "BLUE"
                                        ],
                                        [
                                            ".",
                                            "Color",
                                            "PINK"
                                        ]
                                    ],
                                    [
                                        [
                                            ".",
                                            "Color",
                                            "PINK"
                                        ],
                                        [
                                            ".",
                                            "Color",
                                            "BLUE"
                                        ]
                                    ]
                                ]
                            ],
                            [
                                "rect-mask",
                                [
                                    [
                                        ".",
                                        "jnp",
                                        "array"
                                    ],
                                    [
                                        2,
                                        2
                                    ]
                                ]
                            ]
                        ]
                    ],
                    [
                        "color-background",
                        [
                            ".",
                            "Color",
                            "BLACK"
                        ]
                    ]
                ],
                "code": "(-> (new-grid (jnp.array [4 4]))\n    (draw (jnp.array [0 0]) (apply-texture (jnp.array [[Color.BLUE Color.PINK] [Color.PINK Color.BLUE]]) (rect-mask (jnp.array [2 2]))))\n    (color-background Color.BLACK))"
            },
            "out": {
                "grid": [
                    [
                        2,
                        7,
                        2,
                        7,
                        7,
                        2,
                        7,
                        2
                    ],
                    [
                        7,
                        2,
                        7,
                        2,
                        2,
                        7,
                        2,
                        7
                    ],
                    [
                        2,
                        7,
                        2,
                        7,
                        7,
                        2,
                        7,
                        2
                    ],
                    [
                        7,
                        2,
                        7,
                        2,
                        2,
                        7,
                        2,
                        7
                    ],
                    [
                        7,
                        2,
                        7,
                        2,
                        2,
                        7,
                        2,
                        7
                    ],
                    [
                        2,
                        7,
                        2,
                        7,
                        7,
                        2,
                        7,
                        2
                    ],
                    [
                        7,
                        2,
                        7,
                        2,
                        2,
                        7,
                        2,
                        7
                    ],
                    [
                        2,
                        7,
                        2,
                        7,
                        7,
                        2,
                        7,
                        2
                    ]
                ],
                "expr": [
                    "->",
                    [
                        "new-grid",
                        [
                            "*",
                            2,
                            [
                                [
                                    ".",
                                    "jnp",
                                    "array"
                                ],
                                [
                                    4,
                                    4
                                ]
                            ]
                        ]
                    ],
                    [
                        "draw",
                        [
                            [
                                ".",
                                "jnp",
                                "array"
                            ],
                            [
                                0,
                                0
                            ]
                        ],
                        [
                            "add-quad-mirror",
                            [
                                "apply-texture",
                                [
                                    [
                                        ".",
                                        "jnp",
                                        "array"
                                    ],
                                    [
                                        [
                                            [
                                                ".",
                                                "Color",
                                                "BLUE"
                                            ],
                                            [
                                                ".",
                                                "Color",
                                                "PINK"
                                            ]
                                        ],
                                        [
                                            [
                                                ".",
                                                "Color",
                                                "PINK"
                                            ],
                                            [
                                                ".",
                                                "Color",
                                                "BLUE"
                                            ]
                                        ]
                                    ]
                                ],
                                [
                                    "rect-mask",
                                    [
                                        [
                                            ".",
                                            "jnp",
                                            "array"
                                        ],
                                        [
                                            4,
                                            4
                                        ]
                                    ]
                                ]
                            ]
                        ]
                    ],
                    [
                        "color-background",
                        [
                            ".",
                            "Color",
                            "BLACK"
                        ]
                    ]
                ],
                "code": "(-> (new-grid (* 2 ((. jnp array) [4 4]))) (draw ((. jnp array) [0 0]) (add-quad-mirror (apply-texture ((. jnp array) [[(. Color BLUE) (. Color PINK)] [(. Color PINK) (. Color BLUE)]]) (rect-mask ((. jnp array) [4 4]))))) (color-background (. Color BLACK)))"
            }
        },
        {
            "inp": {
                "grid": [
                    [
                        8,
                        9,
                        1
                    ],
                    [
                        9,
                        8,
                        1
                    ],
                    [
                        1,
                        1,
                        1
                    ]
                ],
                "expr": [
                    "->",
                    [
                        "new-grid",
                        [
                            [
                                ".",
                                "jnp",
                                "array"
                            ],
                            [
                                3,
                                3
                            ]
                        ]
                    ],
                    [
                        "draw",
                        [
                            [
                                ".",
                                "jnp",
                                "array"
                            ],
                            [
                                0,
                                0
                            ]
                        ],
                        [
                            "apply-texture",
                            [
                                [
                                    ".",
                                    "jnp",
                                    "array"
                                ],
                                [
                                    [
                                        [
                                            ".",
                                            "Color",
                                            "ORANGE"
                                        ],
                                        [
                                            ".",
                                            "Color",
                                            "TEAL"
                                        ]
                                    ],
                                    [
                                        [
                                            ".",
                                            "Color",
                                            "TEAL"
                                        ],
                                        [
                                            ".",
                                            "Color",
                                            "ORANGE"
                                        ]
                                    ]
                                ]
                            ],
                            [
                                "rect-mask",
                                [
                                    [
                                        ".",
                                        "jnp",
                                        "array"
                                    ],
                                    [
                                        2,
                                        2
                                    ]
                                ]
                            ]
                        ]
                    ],
                    [
                        "color-background",
                        [
                            ".",
                            "Color",
                            "BLACK"
                        ]
                    ]
                ],
                "code": "(-> (new-grid (jnp.array [3 3]))\n    (draw (jnp.array [0 0]) (apply-texture (jnp.array [[Color.ORANGE Color.TEAL] [Color.TEAL Color.ORANGE]]) (rect-mask (jnp.array [2 2]))))\n    (color-background Color.BLACK))"
            },
            "out": {
                "grid": [
                    [
                        8,
                        9,
                        8,
                        8,
                        9,
                        8
                    ],
                    [
                        9,
                        8,
                        9,
                        9,
                        8,
                        9
                    ],
                    [
                        8,
                        9,
                        8,
                        8,
                        9,
                        8
                    ],
                    [
                        8,
                        9,
                        8,
                        8,
                        9,
                        8
                    ],
                    [
                        9,
                        8,
                        9,
                        9,
                        8,
                        9
                    ],
                    [
                        8,
                        9,
                        8,
                        8,
                        9,
                        8
                    ]
                ],
                "expr": [
                    "->",
                    [
                        "new-grid",
                        [
                            "*",
                            2,
                            [
                                [
                                    ".",
                                    "jnp",
                                    "array"
                                ],
                                [
                                    3,
                                    3
                                ]
                            ]
                        ]
                    ],
                    [
                        "draw",
                        [
                            [
                                ".",
                                "jnp",
                                "array"
                            ],
                            [
                                0,
                                0
                            ]
                        ],
                        [
                            "add-quad-mirror",
                            [
                                "apply-texture",
                                [
                                    [
                                        ".",
                                        "jnp",
                                        "array"
                                    ],
                                    [
                                        [
                                            [
                                                ".",
                                                "Color",
                                                "ORANGE"
                                            ],
                                            [
                                                ".",
                                                "Color",
                                                "TEAL"
                                            ]
                                        ],
                                        [
                                            [
                                                ".",
                                                "Color",
                                                "TEAL"
                                            ],
                                            [
                                                ".",
                                                "Color",
                                                "ORANGE"
                                            ]
                                        ]
                                    ]
                                ],
                                [
                                    "rect-mask",
                                    [
                                        [
                                            ".",
                                            "jnp",
                                            "array"
                                        ],
                                        [
                                            3,
                                            3
                                        ]
                                    ]
                                ]
                            ]
                        ]
                    ],
                    [
                        "color-background",
                        [
                            ".",
                            "Color",
                            "BLACK"
                        ]
                    ]
                ],
                "code": "(-> (new-grid (* 2 ((. jnp array) [3 3]))) (draw ((. jnp array) [0 0]) (add-quad-mirror (apply-texture ((. jnp array) [[(. Color ORANGE) (. Color TEAL)] [(. Color TEAL) (. Color ORANGE)]]) (rect-mask ((. jnp array) [3 3]))))) (color-background (. Color BLACK)))"
            }
        }
    ],
    "test_samples": [
        {
            "inp": {
                "grid": [
                    [
                        5,
                        6,
                        1,
                        1,
                        1,
                        1
                    ],
                    [
                        6,
                        5,
                        1,
                        1,
                        1,
                        1
                    ],
                    [
                        1,
                        1,
                        1,
                        1,
                        1,
                        1
                    ],
                    [
                        1,
                        1,
                        1,
                        1,
                        1,
                        1
                    ],
                    [
                        1,
                        1,
                        1,
                        1,
                        1,
                        1
                    ],
                    [
                        1,
                        1,
                        1,
                        1,
                        1,
                        1
                    ]
                ],
                "expr": [
                    "->",
                    [
                        "new-grid",
                        [
                            [
                                ".",
                                "jnp",
                                "array"
                            ],
                            [
                                6,
                                6
                            ]
                        ]
                    ],
                    [
                        "draw",
                        [
                            [
                                ".",
                                "jnp",
                                "array"
                            ],
                            [
                                0,
                                0
                            ]
                        ],
                        [
                            "apply-texture",
                            [
                                [
                                    ".",
                                    "jnp",
                                    "array"
                                ],
                                [
                                    [
                                        [
                                            ".",
                                            "Color",
                                            "YELLOW"
                                        ],
                                        [
                                            ".",
                                            "Color",
                                            "GREY"
                                        ]
                                    ],
                                    [
                                        [
                                            ".",
                                            "Color",
                                            "GREY"
                                        ],
                                        [
                                            ".",
                                            "Color",
                                            "YELLOW"
                                        ]
                                    ]
                                ]
                            ],
                            [
                                "rect-mask",
                                [
                                    [
                                        ".",
                                        "jnp",
                                        "array"
                                    ],
                                    [
                                        2,
                                        2
                                    ]
                                ]
                            ]
                        ]
                    ],
                    [
                        "color-background",
                        [
                            ".",
                            "Color",
                            "BLACK"
                        ]
                    ]
                ],
                "code": "(-> (new-grid (jnp.array [6 6]))\n    (draw (jnp.array [0 0]) (apply-texture (jnp.array [[Color.YELLOW Color.GREY] [Color.GREY Color.YELLOW]]) (rect-mask (jnp.array [2 2]))))\n    (color-background Color.BLACK))"
            },
            "out": {
                "grid": [
                    [
                        5,
                        6,
                        5,
                        6,
                        5,
                        6,
                        6,
                        5,
                        6,
                        5,
                        6,
                        5
                    ],
                    [
                        6,
                        5,
                        6,
                        5,
                        6,
                        5,
                        5,
                        6,
                        5,
                        6,
                        5,
                        6
                    ],
                    [
                        5,
                        6,
                        5,
                        6,
                        5,
                        6,
                        6,
                        5,
                        6,
                        5,
                        6,
                        5
                    ],
                    [
                        6,
                        5,
                        6,
                        5,
                        6,
                        5,
                        5,
                        6,
                        5,
                        6,
                        5,
                        6
                    ],
                    [
                        5,
                        6,
                        5,
                        6,
                        5,
                        6,
                        6,
                        5,
                        6,
                        5,
                        6,
                        5
                    ],
                    [
                        6,
                        5,
                        6,
                        5,
                        6,
                        5,
                        5,
                        6,
                        5,
                        6,
                        5,
                        6
                    ],
                    [
                        6,
                        5,
                        6,
                        5,
                        6,
                        5,
                        5,
                        6,
                        5,
                        6,
                        5,
                        6
                    ],
                    [
                        5,
                        6,
                        5,
                        6,
                        5,
                        6,
                        6,
                        5,
                        6,
                        5,
                        6,
                        5
                    ],
                    [
                        6,
                        5,
                        6,
                        5,
                        6,
                        5,
                        5,
                        6,
                        5,
                        6,
                        5,
                        6
                    ],
                    [
                        5,
                        6,
                        5,
                        6,
                        5,
                        6,
                        6,
                        5,
                        6,
                        5,
                        6,
                        5
                    ],
                    [
                        6,
                        5,
                        6,
                        5,
                        6,
                        5,
                        5,
                        6,
                        5,
                        6,
                        5,
                        6
                    ],
                    [
                        5,
                        6,
                        5,
                        6,
                        5,
                        6,
                        6,
                        5,
                        6,
                        5,
                        6,
                        5
                    ]
                ],
                "expr": [
                    "->",
                    [
                        "new-grid",
                        [
                            "*",
                            2,
                            [
                                [
                                    ".",
                                    "jnp",
                                    "array"
                                ],
                                [
                                    6,
                                    6
                                ]
                            ]
                        ]
                    ],
                    [
                        "draw",
                        [
                            [
                                ".",
                                "jnp",
                                "array"
                            ],
                            [
                                0,
                                0
                            ]
                        ],
                        [
                            "add-quad-mirror",
                            [
                                "apply-texture",
                                [
                                    [
                                        ".",
                                        "jnp",
                                        "array"
                                    ],
                                    [
                                        [
                                            [
                                                ".",
                                                "Color",
                                                "YELLOW"
                                            ],
                                            [
                                                ".",
                                                "Color",
                                                "GREY"
                                            ]
                                        ],
                                        [
                                            [
                                                ".",
                                                "Color",
                                                "GREY"
                                            ],
                                            [
                                                ".",
                                                "Color",
                                                "YELLOW"
                                            ]
                                        ]
                                    ]
                                ],
                                [
                                    "rect-mask",
                                    [
                                        [
                                            ".",
                                            "jnp",
                                            "array"
                                        ],
                                        [
                                            6,
                                            6
                                        ]
                                    ]
                                ]
                            ]
                        ]
                    ],
                    [
                        "color-background",
                        [
                            ".",
                            "Color",
                            "BLACK"
                        ]
                    ]
                ],
                "code": "(-> (new-grid (* 2 ((. jnp array) [6 6]))) (draw ((. jnp array) [0 0]) (add-quad-mirror (apply-texture ((. jnp array) [[(. Color YELLOW) (. Color GREY)] [(. Color GREY) (. Color YELLOW)]]) (rect-mask ((. jnp array) [6 6]))))) (color-background (. Color BLACK)))"
            }
        }
    ],
    "to_output_fn": "def to_output(expr: hy.models.Expression):\n    # Extract grid size and initial texture\n    grid_size = expr[1][1]\n    texture = expr[2][2][1]\n    \n    # Return expanded grid with mirrored texture\n    return hy_eval(\"\"\"\n      `(-> (new-grid (* 2 ~grid_size))\n           (draw (jnp.array [0 0]) (add-quad-mirror (apply-texture ~texture (rect-mask ~grid_size))))\n           (color-background Color.BLACK))\n    \"\"\")",
    "meta": {
        "concepts_str": "symmetry, grid expansion, color filling",
        "description_str": "The input defines a small shape with a specific color pattern.\nTo create the output, expand this shape to cover a larger grid by applying left-right and up-down mirroring, resulting in a pattern with both horizontal and vertical symmetry.\nThe background color is BLACK, and the shape's colors should remain unchanged."
    }
}